
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://SamuelLarkin.github.io/kb/json/">
      
      
        <link rel="prev" href="../install/">
      
      
        <link rel="next" href="../miller/">
      
      
      <link rel="icon" href="../favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>json - Samuel Larkin's Knowledge Base Documenation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#jsonjsonl" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://github.com/SamuelLarkin/kb" title="Samuel Larkin&#39;s Knowledge Base Documenation" class="md-header__button md-logo" aria-label="Samuel Larkin's Knowledge Base Documenation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Samuel Larkin's Knowledge Base Documenation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              json
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="light-blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/SamuelLarkin/kb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SamuelLarkin / Knowledge Base
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://github.com/SamuelLarkin/kb" title="Samuel Larkin&#39;s Knowledge Base Documenation" class="md-nav__button md-logo" aria-label="Samuel Larkin's Knowledge Base Documenation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Samuel Larkin's Knowledge Base Documenation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/SamuelLarkin/kb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    SamuelLarkin / Knowledge Base
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../color/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Colors
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../config_files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration File Explained
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../fzf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fzf
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    git
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../huggingface/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HuggingFace
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    install
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    json
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    json
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scriptjq" class="md-nav__link">
    <span class="md-ellipsis">
      script.jq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookbook" class="md-nav__link">
    <span class="md-ellipsis">
      Cookbook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggregate-a-field" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate a Field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare" class="md-nav__link">
    <span class="md-ellipsis">
      Compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-to-array" class="md-nav__link">
    <span class="md-ellipsis">
      Convert to Array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-elements" class="md-nav__link">
    <span class="md-ellipsis">
      Counting Elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filename" class="md-nav__link">
    <span class="md-ellipsis">
      Filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-out-subobjects" class="md-nav__link">
    <span class="md-ellipsis">
      Filter-out SubObjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-files-to-structured-json" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Files to Structured json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-by-x-and-merge" class="md-nav__link">
    <span class="md-ellipsis">
      Group by X and Merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-in-a-set" class="md-nav__link">
    <span class="md-ellipsis">
      Value in a Set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-to-json" class="md-nav__link">
    <span class="md-ellipsis">
      XML to json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zip-multiple-files" class="md-nav__link">
    <span class="md-ellipsis">
      Zip Multiple files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../miller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miller
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../miscellaneous/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../nvim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nvim
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ollama/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ollama
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../perl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Perl
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../putty/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Putty
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rsync/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rsync
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../slurm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SLURM
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../tmux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tmux
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../vscode/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    vscode
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#scriptjq" class="md-nav__link">
    <span class="md-ellipsis">
      script.jq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cookbook" class="md-nav__link">
    <span class="md-ellipsis">
      Cookbook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cookbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aggregate-a-field" class="md-nav__link">
    <span class="md-ellipsis">
      Aggregate a Field
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compare" class="md-nav__link">
    <span class="md-ellipsis">
      Compare
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#convert-to-array" class="md-nav__link">
    <span class="md-ellipsis">
      Convert to Array
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#counting-elements" class="md-nav__link">
    <span class="md-ellipsis">
      Counting Elements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filename" class="md-nav__link">
    <span class="md-ellipsis">
      Filename
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#filter-out-subobjects" class="md-nav__link">
    <span class="md-ellipsis">
      Filter-out SubObjects
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flat-files-to-structured-json" class="md-nav__link">
    <span class="md-ellipsis">
      Flat Files to Structured json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-by-x-and-merge" class="md-nav__link">
    <span class="md-ellipsis">
      Group by X and Merge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parallel-processing" class="md-nav__link">
    <span class="md-ellipsis">
      Parallel Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#value-in-a-set" class="md-nav__link">
    <span class="md-ellipsis">
      Value in a Set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xml-to-json" class="md-nav__link">
    <span class="md-ellipsis">
      XML to json
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#zip-multiple-files" class="md-nav__link">
    <span class="md-ellipsis">
      Zip Multiple files
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="jsonjsonl">JSON/JSONL<a class="headerlink" href="#jsonjsonl" title="Permanent link">&para;</a></h1>
<p><a href="https://jqlang.org/manual/">jq manual</a></p>
<h2 id="scriptjq">script.jq<a class="headerlink" href="#scriptjq" title="Permanent link">&para;</a></h2>
<p>To make a <code>jq</code> script executable:</p>
<pre><code class="language-sh">#!/usr/bin/env -S jq --monochrome-output --compact-output --from-file
# -S, --split-string=S

# your `jq` filters
</code></pre>
<h2 id="cookbook">Cookbook<a class="headerlink" href="#cookbook" title="Permanent link">&para;</a></h2>
<h3 id="aggregate-a-field">Aggregate a Field<a class="headerlink" href="#aggregate-a-field" title="Permanent link">&para;</a></h3>
<p>Given a list of objects where some of them have the same <code>id</code> but with a field with different values, aggregate that field for each object.
This happens when you extracted data from <code>mysql</code>.
<code>mysql</code> doesn't allow subqueries to return multiple rows with multiple columns thus you have to do the same work using <code>JOIN</code>.
<a href="https://stackoverflow.com/a/42012281">Merge Arrays of JSON</a></p>
<pre><code class="language-sh">echo -e '{&quot;id&quot;:1, &quot;b&quot;:[{&quot;c&quot;:1}]}{&quot;id&quot;:1, &quot;b&quot;:[{&quot;c&quot;:2}]}'
</code></pre>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;b&quot;: [
    {
      &quot;c&quot;: 1
    }
  ]
}
{
  &quot;id&quot;: 1,
  &quot;b&quot;: [
    {
      &quot;c&quot;: 2
    }
  ]
}
</code></pre>
<ul>
<li>group entries by <code>id</code></li>
<li>for each group</li>
<li>take the first element and aggregate all of the <code>b</code> in a list</li>
<li>return that first element that has been augmented with a list of <code>b</code></li>
</ul>
<pre><code class="language-sh">echo -e '{&quot;id&quot;:1, &quot;b&quot;:[{&quot;c&quot;:1}]}{&quot;id&quot;:1, &quot;b&quot;:[{&quot;c&quot;:2}]}' \
| jq --slurp 'group_by(.id) | .[] | (.[0].b=([.[].b]|flatten)) | .[0]'
</code></pre>
<pre><code>{
  &quot;id&quot;: 1,
  &quot;b&quot;: [
    {
      &quot;c&quot;: 1
    },
    {
      &quot;c&quot;: 2
    }
  ]
}
</code></pre>
<h3 id="compare">Compare<a class="headerlink" href="#compare" title="Permanent link">&para;</a></h3>
<p>Compare two jsonl files that are not in the same order.
This implies that we need to sort the files on some <code>key</code>.
Do a trick a la <code>Schwartian transform</code> where we prepend the sort <code>key</code>, sort on that <code>key</code> and the remove the <code>key</code>.</p>
<pre><code class="language-sh">jqdiff \
  &lt;(zcat train.jsonl.gz \
    | jq --compact-output --raw-output '[.id, .|@text] | @tsv' \
    | sort -k1,1 \
    | cut -f2,2) \
  &lt;(zcat source/train.jsonl.gz \
    | jq --compact-output --raw-output '[.id, .|@text] | @tsv' \
    | sort -k1,1 \
    | cut -f 2,2)
</code></pre>
<p>Otherwise, use the alias <code>jqdiff</code> which essentially does</p>
<pre><code class="language-sh">vimdiff &lt;(jq --sort-keys . file1.json) &lt;(jq --sort-keys . file2.json)
</code></pre>
<h3 id="convert-to-array">Convert to Array<a class="headerlink" href="#convert-to-array" title="Permanent link">&para;</a></h3>
<p>Given</p>
<pre><code class="language-json">[{ &quot;seg&quot;: [&quot;A&quot;, &quot;B&quot;] }, { &quot;seg&quot;: &quot;C&quot; }]
</code></pre>
<p>The second object is NOT an array but you need it to be an array to process all elements the same way, you can make sure all segments are arrays by doing:</p>
<pre><code class="language-sh">jq '.[] | .seg | (if type == &quot;object&quot; then [.] else . end) | .[]'
</code></pre>
<h3 id="counting-elements">Counting Elements<a class="headerlink" href="#counting-elements" title="Permanent link">&para;</a></h3>
<p>Count the number of entries/sentence pairs that have the <code>.unparsable</code> key.</p>
<pre><code class="language-sh">pv Huge.jsonl \
| jq --null-input '[ inputs | select(.unparsable)] | reduce .[] as $item (0; . + 1)'
</code></pre>
<h3 id="filename">Filename<a class="headerlink" href="#filename" title="Permanent link">&para;</a></h3>
<p>If you need the file name in your script, you can call the function <code>input_filename</code>.</p>
<pre><code class="language-sh">jq '[input_filename, input_line_number]' translation/nmt/test.en2fr.scores.json
</code></pre>
<pre><code>[
  &quot;translation/nmt/test.en2fr.scores.json&quot;,
  53
]
</code></pre>
<h3 id="filter-out-subobjects">Filter-out SubObjects<a class="headerlink" href="#filter-out-subobjects" title="Permanent link">&para;</a></h3>
<p>Given</p>
<pre><code class="language-xml">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;dataset id=&quot;wmttest2024&quot;&gt;
  &lt;collection id=&quot;general&quot;&gt;
    &lt;doc origlang=&quot;en&quot; id=&quot;test-en-news_beverly_press.3585&quot; domain=&quot;news&quot;&gt;
      &lt;src lang=&quot;en&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Siso's depictions of land, water center new gallery exhibition&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/src&gt;
      &lt;ref lang=&quot;es&quot; translator=&quot;refA&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Representaciones de la tierra y el agua de Siso centran una nueva exposición&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/ref&gt;
    &lt;/doc&gt;
    &lt;doc origlang=&quot;en&quot; id=&quot;test-en-news_brisbanetimes.com.au.228963&quot; domain=&quot;NOT_news&quot;&gt;
      &lt;src lang=&quot;en&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Adapt the old, accommodate the new to solve issue&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/src&gt;
      &lt;ref lang=&quot;es&quot; translator=&quot;refA&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Adapta lo viejo, incorpora lo nuevo para resolver el problema&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/ref&gt;
    &lt;/doc&gt;
  &lt;/collection&gt;
&lt;/dataset&gt;
</code></pre>
<p>Remove documents that are NOT of <code>news</code> domain keeping the document's structure.</p>
<pre><code class="language-sh">~/.local/bin/yq 'del(.dataset.collection.doc[] | select(.[&quot;+@domain&quot;] != &quot;news&quot;))' wmttest2024.en-es.xml
</code></pre>
<pre><code class="language-xml">&lt;?xml version='1.0' encoding='utf-8'?&gt;
&lt;dataset id=&quot;wmttest2024&quot;&gt;
  &lt;collection id=&quot;general&quot;&gt;
    &lt;doc origlang=&quot;en&quot; id=&quot;test-en-news_beverly_press.3585&quot; domain=&quot;news&quot;&gt;
      &lt;src lang=&quot;en&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Siso's depictions of land, water center new gallery exhibition&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/src&gt;
      &lt;ref lang=&quot;es&quot; translator=&quot;refA&quot;&gt;
        &lt;p&gt;
          &lt;seg id=&quot;1&quot;&gt;Representaciones de la tierra y el agua de Siso centran una nueva exposición&lt;/seg&gt;
        &lt;/p&gt;
      &lt;/ref&gt;
    &lt;/doc&gt;
  &lt;/collection&gt;
&lt;/dataset&gt;
</code></pre>
<h3 id="flat-files-to-structured-json">Flat Files to Structured json<a class="headerlink" href="#flat-files-to-structured-json" title="Permanent link">&para;</a></h3>
<p>When you have multiple flat files that you want to combine into a structured json.</p>
<p><em>lingua_eng_spa/Tilde-worldbank-1-eng-spa.spa.gz</em></p>
<pre><code>SPA     0.9998978843092705
SPA     0.9991979235059277
</code></pre>
<p><em>lingua_all_languages/Tilde-worldbank-1-eng-spa.spa.gz</em></p>
<pre><code>SPA     0.9999975457963204
SPA     0.9847735076254288
</code></pre>
<p><em>Tilde-worldbank-1-eng-spa.spa.gz</em></p>
<pre><code>&quot;Igualmente, hacemos notar la importancia de abordar el problema del hambre y la malnutrición”.
&quot;La vida es muy difícil.
</code></pre>
<p><em>Tilde-worldbank-1-eng-spa.eng.gz</em></p>
<pre><code>&quot; We also note the importance of addressing hunger and malnutrition.”
&quot;[Life] is extremely difficult.
</code></pre>
<pre><code class="language-sh">paste \
  &lt;(zcat lingua_eng_spa/Tilde-worldbank-1-eng-spa.spa.gz) \
  &lt;(zcat lingua_all_languages/Tilde-worldbank-1-eng-spa.spa.gz) \
  &lt;(zcat Tilde-worldbank-1-eng-spa.spa.gz) \
  &lt;(zcat Tilde-worldbank-1-eng-spa.eng.gz) \
| mlr --tsv --ojson --implicit-csv-header \
  label eng_spa.lid,eng_spa.confidence,all.lid,all.confidence,spa,eng \
| jq '.[]'
</code></pre>
<pre><code class="language-json">{
  &quot;eng_spa&quot;: {
    &quot;lid&quot;: &quot;SPA&quot;,
    &quot;confidence&quot;: 0.9998978843092705
  },
  &quot;all&quot;: {
    &quot;lid&quot;: &quot;SPA&quot;,
    &quot;confidence&quot;: 0.9999975457963204
  },
  &quot;spa&quot;: &quot;\&quot;Igualmente, hacemos notar la importancia de abordar el problema del hambre y la malnutrición”.&quot;,
  &quot;eng&quot;: &quot;\&quot; We also note the importance of addressing hunger and malnutrition.”&quot;
}
{
  &quot;eng_spa&quot;: {
    &quot;lid&quot;: &quot;SPA&quot;,
    &quot;confidence&quot;: 0.9991979235059277
  },
  &quot;all&quot;: {
    &quot;lid&quot;: &quot;SPA&quot;,
    &quot;confidence&quot;: 0.9847735076254288
  },
  &quot;spa&quot;: &quot;\&quot;La vida es muy difícil.&quot;,
  &quot;eng&quot;: &quot;\&quot;[Life] is extremely difficult.&quot;
}
</code></pre>
<h3 id="group-by-x-and-merge">Group by X and Merge<a class="headerlink" href="#group-by-x-and-merge" title="Permanent link">&para;</a></h3>
<p>Context: after generating <code>*.scores.json</code> using <code>sacrebleu  --width=14 reference --metrics bleu chrf ter  &lt; translation &gt; scores.json</code>.
Can we extract BLEU scores from all our experiments and tabulate the result using <code>mlr</code>?</p>
<pre><code class="language-sh">find -type f -name \*scores.json \
| xargs dirname \
| parallel 'jq &quot;{\&quot;expt_name\&quot;: \&quot;{//}\&quot;,  \&quot;{/}\&quot;: (.[] | select(.name == \&quot;BLEU\&quot;) | .score)}&quot; {}/*scores.json' \
| jq --slurp --sort-keys 'group_by(.expt_name) | [.[] | add]' \
| mlr --json --opprint --barred cat \
| less
</code></pre>
<h3 id="parallel-processing">Parallel Processing<a class="headerlink" href="#parallel-processing" title="Permanent link">&para;</a></h3>
<p>Note that we use <code>--keep-order</code>, <code>--spreadstdin</code> &amp; <code>--recend='\n'</code>.</p>
<pre><code class="language-sh">function process {
   cat
}
export -f process

zcat input.gz \
    | time \parallel \
       --keep-order \
       --spreadstdin \
       --recend='\n' \
       --env=process \
       'process' \
| gzip \
&gt; output.gz
</code></pre>
<h3 id="value-in-a-set">Value in a Set<a class="headerlink" href="#value-in-a-set" title="Permanent link">&para;</a></h3>
<p>Select entries that have a field value within a set.</p>
<pre><code class="language-sh">jq 'select(.BlockID == (1742974, 1742975))' data/hoc-log-20241218-blocks.json
</code></pre>
<h3 id="xml-to-json">XML to json<a class="headerlink" href="#xml-to-json" title="Permanent link">&para;</a></h3>
<p>Using <a href="https://github.com/mikefarah/yq/">yq</a>, we can convert a xml document into a json file.</p>
<pre><code class="language-sh">yq -p xml -o json &lt; input.xml &gt; output.json
</code></pre>
<h3 id="zip-multiple-files">Zip Multiple files<a class="headerlink" href="#zip-multiple-files" title="Permanent link">&para;</a></h3>
<p><a href="https://github.com/jqlang/jq/issues/680">Merge arrays</a>
The key here is the <code>transpose</code>.</p>
<pre><code class="language-sh">zcat translation.fr.json.gz \
| jq \
    --slurp \
    --argfile src &lt;(jq --raw-input '{&quot;src&quot;:.}' source.en) \
    --argfile ref &lt;(jq --raw-input '{&quot;ref&quot;:.}' reference.fr) \
    '[., $src, $ref] | transpose | map(add) | .[]'
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.copy", "content.code.select", "announce.dismiss"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "stable", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>